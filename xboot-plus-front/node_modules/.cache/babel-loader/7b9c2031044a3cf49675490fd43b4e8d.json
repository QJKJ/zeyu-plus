{"remainingRequest":"Z:\\zeyu\\zeyu-plus\\xboot-plus-front\\node_modules\\babel-loader\\lib\\index.js!Z:\\zeyu\\zeyu-plus\\xboot-plus-front\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!Z:\\zeyu\\zeyu-plus\\xboot-plus-front\\src\\views\\Main.vue?vue&type=script&lang=js&","dependencies":[{"path":"Z:\\zeyu\\zeyu-plus\\xboot-plus-front\\src\\views\\Main.vue","mtime":1546932158106},{"path":"Z:\\zeyu\\zeyu-plus\\xboot-plus-front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1545803981415},{"path":"Z:\\zeyu\\zeyu-plus\\xboot-plus-front\\node_modules\\babel-loader\\lib\\index.js","mtime":1529635966000},{"path":"Z:\\zeyu\\zeyu-plus\\xboot-plus-front\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport shrinkableMenu from \"./main-components/shrinkable-menu/shrinkable-menu.vue\";\nimport tagsPageOpened from \"./main-components/tags-page-opened.vue\";\nimport breadcrumbNav from \"./main-components/breadcrumb-nav.vue\";\nimport fullScreen from \"./main-components/fullscreen.vue\";\nimport lockScreen from \"./main-components/lockscreen/lockscreen.vue\";\nimport messageTip from \"./main-components/message-tip.vue\";\nimport Cookies from \"js-cookie\";\nimport util from \"@/libs/util.js\";\nimport { ws, getMessageSendData } from \"@/api/index\";\nexport default {\n  components: {\n    shrinkableMenu: shrinkableMenu,\n    tagsPageOpened: tagsPageOpened,\n    breadcrumbNav: breadcrumbNav,\n    fullScreen: fullScreen,\n    lockScreen: lockScreen,\n    messageTip: messageTip\n  },\n  data: function data() {\n    return {\n      shrink: false,\n      username: \"\",\n      core: {},\n      userId: \"\",\n      isFullScreen: false,\n      openedSubmenuArr: this.$store.state.app.openedSubmenuArr\n    };\n  },\n  computed: {\n    menuList: function menuList() {\n      return this.$store.state.app.menuList;\n    },\n    pageTagsList: function pageTagsList() {\n      return this.$store.state.app.pageOpenedList; // 打开的页面的页面对象\n    },\n    currentPath: function currentPath() {\n      return this.$store.state.app.currentPath; // 当前面包屑数组\n    },\n    avatarPath: function avatarPath() {\n      return localStorage.avatorImgPath;\n    },\n    cachePage: function cachePage() {\n      return this.$store.state.app.cachePage;\n    },\n    lang: function lang() {\n      return this.$store.state.app.lang;\n    },\n    menuTheme: function menuTheme() {\n      return this.$store.state.app.menuTheme;\n    },\n    mesCount: function mesCount() {\n      return this.$store.state.app.messageCount;\n    }\n  },\n  stompClient: {\n    monitorIntervalTime: 100,\n    stompReconnect: true,\n    timeout: function timeout(orgCmd) {}\n  },\n  methods: {\n    init: function init() {\n      var _this = this;\n\n      var coreData = {};\n      $.ajax({\n        url: '/xboot/setting/core',\n        type: 'GET',\n        //GET\n        async: false,\n        //或false,是否异步\n        data: {},\n        timeout: 5000,\n        //超时时间\n        dataType: 'json',\n        //返回的数据格式：\n        beforeSend: function beforeSend(xhr) {},\n        success: function success(data, textStatus, jqXHR) {\n          coreData = data.result;\n          $('[rel=\"icon\"]').attr(\"href\", coreData.iconIco);\n        },\n        error: function error(xhr, textStatus) {},\n        complete: function complete() {}\n      });\n      this.core = coreData;\n      var pathArr = util.setCurrentPath(this, this.$route.name); // this.$store.commit(\"updateMenulist\");\n\n      if (pathArr.length >= 2) {\n        this.$store.commit(\"addOpenSubmenu\", pathArr[1].name);\n      }\n\n      var userInfo = JSON.parse(Cookies.get(\"userInfo\"));\n      this.username = userInfo.username;\n      this.userId = userInfo.id;\n      this.checkTag(this.$route.name); // 读取未读消息数\n\n      getMessageSendData({\n        userId: userInfo.id,\n        status: 0\n      }).then(function (res) {\n        if (res.success === true) {\n          _this.$store.commit(\"setMessageCount\", res.result.totalElements);\n        }\n      });\n      this.connectSrv();\n    },\n    onConnected: function onConnected(frame) {\n      // console.log(\"连接ws成功: \" + frame);\n      // 订阅广播系统通知\n      this.$stompClient.subscribe(\"/topic/subscribe\", this.responseCallback, this.onFailed); // 订阅点对点 通过用户id指定用户\n\n      this.$stompClient.subscribe(\"/user/\" + this.userId + \"/queue/subscribe\", this.responseCallback, this.onFailed);\n    },\n    onFailed: function onFailed(frame) {\n      console.log(\"连接ws失败： \" + JSON.stringify(frame));\n    },\n    connectSrv: function connectSrv() {\n      var headers = {};\n      this.connetWM(ws, headers, this.onConnected, this.onFailed);\n    },\n    responseCallback: function responseCallback(frame) {\n      // console.log(\"收到消息：\" + frame.body);\n      this.$store.commit(\"setMessageCount\", this.mesCount + 1);\n    },\n    disconnect: function disconnect() {\n      this.disconnetWM();\n    },\n    toggleClick: function toggleClick() {\n      this.shrink = !this.shrink;\n    },\n    handleLanDropdown: function handleLanDropdown(name) {\n      localStorage.lang = name;\n      this.$store.commit(\"switchLang\", name);\n    },\n    handleClickUserDropdown: function handleClickUserDropdown(name) {\n      if (name === \"ownSpace\") {\n        util.openNewPage(this, \"ownspace_index\");\n        this.$router.push({\n          name: \"ownspace_index\"\n        });\n      } else if (name === \"ownSpaceOld\") {\n        util.openNewPage(this, \"ownspace_old\");\n        this.$router.push({\n          name: \"ownspace_old\"\n        });\n      } else if (name === \"changePass\") {\n        util.openNewPage(this, \"change_pass\");\n        this.$router.push({\n          name: \"change_pass\"\n        });\n      } else if (name === \"loginout\") {\n        // 退出登录\n        this.$store.commit(\"logout\", this);\n        this.$store.commit(\"clearOpenedSubmenu\"); // 强制刷新页面 重新加载router\n\n        location.reload();\n      }\n    },\n    checkTag: function checkTag(name) {\n      var openpageHasTag = this.pageTagsList.some(function (item) {\n        if (item.name === name) {\n          return true;\n        }\n      });\n\n      if (!openpageHasTag) {\n        //  解决关闭当前标签后再点击回退按钮会退到当前页时没有标签的问题\n        util.openNewPage(this, name, this.$route.params || {}, this.$route.query || {});\n      }\n    },\n    handleSubmenuChange: function handleSubmenuChange(val) {// console.log(val)\n    },\n    beforePush: function beforePush(name) {\n      // console.log(name)\n      return true;\n    },\n    fullscreenChange: function fullscreenChange(isFullScreen) {// console.log(isFullScreen);\n    }\n  },\n  watch: {\n    $route: function $route(to) {\n      this.$store.commit(\"setCurrentPageName\", to.name);\n      var pathArr = util.setCurrentPath(this, to.name);\n\n      if (pathArr.length > 2) {\n        this.$store.commit(\"addOpenSubmenu\", pathArr[1].name);\n      }\n\n      this.checkTag(to.name);\n      localStorage.currentPageName = to.name;\n    },\n    lang: function lang() {\n      util.setCurrentPath(this, this.$route.name); // 在切换语言时用于刷新面包屑\n    }\n  },\n  mounted: function mounted() {\n    this.init();\n    $(\".cavs,#templatemo_banner_slide\").remove();\n  },\n  created: function created() {\n    // 显示打开的页面的列表\n    this.$store.commit(\"setOpenedList\");\n  }\n};",{"version":3,"sources":["Main.vue"],"names":[],"mappings":"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","sourcesContent":["<style lang=\"less\">\r\n@import \"./main.less\";\r\n</style>\r\n\r\n<template>\r\n  <div class=\"main\" :class=\"{'main-hide-text': shrink}\">\r\n    <div class=\"sidebar-menu-con menu-bar\" :style=\"{width: shrink?'60px':'220px', overflow: shrink ? 'visible' : 'auto'}\">\r\n      <shrinkable-menu :shrink=\"shrink\" @on-change=\"handleSubmenuChange\" :theme=\"menuTheme\" :before-push=\"beforePush\" :open-names=\"openedSubmenuArr\" :menu-list=\"menuList\">\r\n        <div slot=\"top\" class=\"logo-con\">\r\n          <img v-show=\"!shrink\" :src=\"core.homeLogo\"  key=\"max-logo\" />\r\n          <img v-show=\"shrink\" :src=\"core.shrinkLogo\" key=\"min-logo\" />\r\n        </div>\r\n      </shrinkable-menu>\r\n    </div>\r\n    <div class=\"main-header-con\" :style=\"{paddingLeft: shrink?'60px':'220px'}\">\r\n      <div class=\"main-header\">\r\n        <div class=\"navicon-con\">\r\n          <Button :style=\"{transform: 'rotateZ(' + (this.shrink ? '-90' : '0') + 'deg)'}\" type=\"text\" @click=\"toggleClick\">\r\n                            <Icon type=\"md-menu\" size=\"32\"></Icon>\r\n                        </Button>\r\n        </div>\r\n        <div class=\"header-middle-con\">\r\n          <div class=\"main-breadcrumb\">\r\n            <breadcrumb-nav :currentPath=\"currentPath\"></breadcrumb-nav>\r\n          </div>\r\n        </div>\r\n        <div class=\"header-avator-con\">\r\n          <full-screen v-model=\"isFullScreen\" @on-change=\"fullscreenChange\"></full-screen>\r\n          <Dropdown @on-click=\"handleLanDropdown\" class=\"options\">\r\n            <Icon type=\"md-globe\" :size=\"24\" class=\"language\"></Icon>\r\n            <DropdownMenu slot=\"list\">\r\n              <DropdownItem name=\"zh-CN\">中文</DropdownItem>\r\n              <DropdownItem name=\"en-US\">English</DropdownItem>\r\n            </DropdownMenu>\r\n          </Dropdown>\r\n          <lock-screen></lock-screen>\r\n          <message-tip v-model=\"mesCount\"></message-tip>\r\n          <div class=\"user-dropdown-menu-con\">\r\n            <Row type=\"flex\" justify=\"end\" align=\"middle\" class=\"user-dropdown-innercon\">\r\n              <Dropdown transfer trigger=\"hover\" @on-click=\"handleClickUserDropdown\">\r\n                <a href=\"javascript:void(0)\">\r\n                  <span class=\"main-user-name\">{{ username }}</span>\r\n                  <Icon type=\"md-arrow-dropdown\" />\r\n                  <Avatar :src=\"avatarPath\" style=\"background: #619fe7;margin-left: 10px;\"></Avatar>\r\n                </a>\r\n                <DropdownMenu slot=\"list\">\r\n                  <DropdownItem name=\"ownSpace\">{{ $t('userCenter') }}</DropdownItem>\r\n                  <DropdownItem name=\"ownSpaceOld\">{{ $t('userCenterOld') }}</DropdownItem>\r\n                  <DropdownItem name=\"changePass\">{{ $t('changePass') }}</DropdownItem>\r\n                  <DropdownItem name=\"loginout\" divided>{{ $t('logout') }}</DropdownItem>\r\n                </DropdownMenu>\r\n              </Dropdown>\r\n            </Row>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div class=\"tags-con\">\r\n        <tags-page-opened :pageTagsList=\"pageTagsList\"></tags-page-opened>\r\n      </div>\r\n    </div>\r\n    <div class=\"single-page-con\" :style=\"{left: shrink?'60px':'220px'}\">\r\n      <div class=\"single-page\">\r\n        <keep-alive :include=\"cachePage\">\r\n          <router-view></router-view>\r\n        </keep-alive>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n\r\nimport shrinkableMenu from \"./main-components/shrinkable-menu/shrinkable-menu.vue\";\r\nimport tagsPageOpened from \"./main-components/tags-page-opened.vue\";\r\nimport breadcrumbNav from \"./main-components/breadcrumb-nav.vue\";\r\nimport fullScreen from \"./main-components/fullscreen.vue\";\r\nimport lockScreen from \"./main-components/lockscreen/lockscreen.vue\";\r\nimport messageTip from \"./main-components/message-tip.vue\";\r\nimport Cookies from \"js-cookie\";\r\nimport util from \"@/libs/util.js\";\r\nimport { ws, getMessageSendData} from \"@/api/index\";\r\n\r\n\r\n\r\nexport default {\r\n  components: {\r\n    shrinkableMenu,\r\n    tagsPageOpened,\r\n    breadcrumbNav,\r\n    fullScreen,\r\n    lockScreen,\r\n    messageTip\r\n  },\r\n  data() {\r\n    return {\r\n      shrink: false,\r\n      username: \"\",\r\n      core:{},\r\n      userId: \"\",\r\n      isFullScreen: false,\r\n      openedSubmenuArr: this.$store.state.app.openedSubmenuArr\r\n    };\r\n  },\r\n  computed: {\r\n    menuList() {\r\n      return this.$store.state.app.menuList;\r\n    },\r\n    pageTagsList() {\r\n      return this.$store.state.app.pageOpenedList; // 打开的页面的页面对象\r\n    },\r\n    currentPath() {\r\n      return this.$store.state.app.currentPath; // 当前面包屑数组\r\n    },\r\n    avatarPath() {\r\n      return localStorage.avatorImgPath;\r\n    },\r\n    cachePage() {\r\n      return this.$store.state.app.cachePage;\r\n    },\r\n    lang() {\r\n      return this.$store.state.app.lang;\r\n    },\r\n    menuTheme() {\r\n      return this.$store.state.app.menuTheme;\r\n    },\r\n    mesCount() {\r\n      return this.$store.state.app.messageCount;\r\n    }\r\n  },\r\n  stompClient: {\r\n    monitorIntervalTime: 100,\r\n    stompReconnect: true,\r\n    timeout(orgCmd) {}\r\n  },\r\n  methods: {\r\n    init() {\r\n      var coreData = {};\r\n      $.ajax({\r\n          url:'/xboot/setting/core',\r\n          type:'GET', //GET\r\n          async:false,    //或false,是否异步\r\n          data:{},\r\n          timeout:5000,    //超时时间\r\n          dataType:'json',    //返回的数据格式：\r\n          beforeSend:function(xhr){\r\n          },\r\n          success:function(data,textStatus,jqXHR){\r\n              coreData = data.result;\r\n              $('[rel=\"icon\"]').attr(\"href\",coreData.iconIco);\r\n          },\r\n          error:function(xhr,textStatus){\r\n          },\r\n          complete:function(){\r\n          }\r\n      });\r\n      this.core = coreData;\r\n      let pathArr = util.setCurrentPath(this, this.$route.name);\r\n      // this.$store.commit(\"updateMenulist\");\r\n      if (pathArr.length >= 2) {\r\n        this.$store.commit(\"addOpenSubmenu\", pathArr[1].name);\r\n      }\r\n      let userInfo = JSON.parse(Cookies.get(\"userInfo\"));\r\n      this.username = userInfo.username;\r\n      this.userId = userInfo.id;\r\n      this.checkTag(this.$route.name);\r\n      // 读取未读消息数\r\n      getMessageSendData({\r\n        userId: userInfo.id,\r\n        status: 0\r\n      }).then(res => {\r\n        if (res.success === true) {\r\n          this.$store.commit(\"setMessageCount\", res.result.totalElements);\r\n        }\r\n      });\r\n      this.connectSrv();\r\n    },\r\n    onConnected(frame) {\r\n      // console.log(\"连接ws成功: \" + frame);\r\n      // 订阅广播系统通知\r\n      this.$stompClient.subscribe(\r\n        \"/topic/subscribe\",\r\n        this.responseCallback,\r\n        this.onFailed\r\n      );\r\n      // 订阅点对点 通过用户id指定用户\r\n      this.$stompClient.subscribe(\r\n        \"/user/\" + this.userId + \"/queue/subscribe\",\r\n        this.responseCallback,\r\n        this.onFailed\r\n      );\r\n    },\r\n    onFailed(frame) {\r\n      console.log(\"连接ws失败： \" + JSON.stringify(frame));\r\n    },\r\n    connectSrv() {\r\n      var headers = {};\r\n      this.connetWM(ws, headers, this.onConnected, this.onFailed);\r\n    },\r\n    responseCallback(frame) {\r\n      // console.log(\"收到消息：\" + frame.body);\r\n      this.$store.commit(\"setMessageCount\", this.mesCount + 1);\r\n    },\r\n    disconnect() {\r\n      this.disconnetWM();\r\n    },\r\n    toggleClick() {\r\n      this.shrink = !this.shrink;\r\n    },\r\n    handleLanDropdown(name) {\r\n      localStorage.lang = name;\r\n      this.$store.commit(\"switchLang\", name);\r\n    },\r\n    handleClickUserDropdown(name) {\r\n      if (name === \"ownSpace\") {\r\n        util.openNewPage(this, \"ownspace_index\");\r\n        this.$router.push({\r\n          name: \"ownspace_index\"\r\n        });\r\n      } else if (name === \"ownSpaceOld\") {\r\n        util.openNewPage(this, \"ownspace_old\");\r\n        this.$router.push({\r\n          name: \"ownspace_old\"\r\n        });\r\n      } else if (name === \"changePass\") {\r\n        util.openNewPage(this, \"change_pass\");\r\n        this.$router.push({\r\n          name: \"change_pass\"\r\n        });\r\n      } else if (name === \"loginout\") {\r\n        // 退出登录\r\n        this.$store.commit(\"logout\", this);\r\n        this.$store.commit(\"clearOpenedSubmenu\");\r\n        // 强制刷新页面 重新加载router\r\n        location.reload();\r\n      }\r\n    },\r\n    checkTag(name) {\r\n      let openpageHasTag = this.pageTagsList.some(item => {\r\n        if (item.name === name) {\r\n          return true;\r\n        }\r\n      });\r\n      if (!openpageHasTag) {\r\n        //  解决关闭当前标签后再点击回退按钮会退到当前页时没有标签的问题\r\n        util.openNewPage(\r\n          this,\r\n          name,\r\n          this.$route.params || {},\r\n          this.$route.query || {}\r\n        );\r\n      }\r\n    },\r\n    handleSubmenuChange(val) {\r\n      // console.log(val)\r\n    },\r\n    beforePush(name) {\r\n      // console.log(name)\r\n      return true;\r\n    },\r\n    fullscreenChange(isFullScreen) {\r\n      // console.log(isFullScreen);\r\n    }\r\n  },\r\n  watch: {\r\n    $route(to) {\r\n      this.$store.commit(\"setCurrentPageName\", to.name);\r\n      let pathArr = util.setCurrentPath(this, to.name);\r\n      if (pathArr.length > 2) {\r\n        this.$store.commit(\"addOpenSubmenu\", pathArr[1].name);\r\n      }\r\n      this.checkTag(to.name);\r\n      localStorage.currentPageName = to.name;\r\n    },\r\n    lang() {\r\n      util.setCurrentPath(this, this.$route.name); // 在切换语言时用于刷新面包屑\r\n    }\r\n  },\r\n  mounted() {\r\n    this.init();\r\n       $(\".cavs,#templatemo_banner_slide\").remove();\r\n  },\r\n  created() {\r\n    // 显示打开的页面的列表\r\n    this.$store.commit(\"setOpenedList\");\r\n  }\r\n};\r\n</script>\r\n"],"sourceRoot":"src\\views"}]}